# ูุธุงู ุงูุชุฑุฎูุต ุงููุฑุชุจุท ุจุงููุงุฑุฏููุฑ (Hardware-Bound License System)

**ุชุงุฑูุฎ ุงูุชูููุฐ:** 2025-01-23  
**ุงูุญุงูุฉ:** โ ููุชูู

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุงุณุชุจุฏุงู ูุธุงู ุงูุชุฑุฎูุต ุงููุฏูู (PIN-based) ุจูุธุงู ุชุฑุฎูุต ุฌุฏูุฏ ูุฑุชุจุท ุจูุงุฑุฏููุฑ ุงูุฌูุงุฒ.

### ุงููุจุฏุฃ ุงูุฃุณุงุณู
- ูู ููุชุงุญ ุชูุนูู ูุนูู ุนูู **ุฌูุงุฒ ูุงุญุฏ ููุท**
- ูุง ูููู ููู ุงูููุชุงุญ ุฅูู ุฌูุงุฒ ุขุฎุฑ
- ุงููุธุงู ูุนูู ุจุงููุงูู **Offline** (ุจุฏูู ุฅูุชุฑูุช)
- ูุฑุชุจุท ุจูุนุฑู ูุฑูุฏ ูููุงุฑุฏููุฑ (Hardware ID)

---

## ๐๏ธ ุงูุจููุฉ ุงูุชูููุฉ

### 1. ุงููููุงุช ุงูุฑุฆูุณูุฉ

#### Backend (Main Process)
```
src/main/core/services/
โโโ HardwareIdService.ts        # ุฎุฏูุฉ ุงูุญุตูู ุนูู ูุนุฑู ุงูุฌูุงุฒ
โโโ HardwareLicenseService.ts   # ุฎุฏูุฉ ุฅุฏุงุฑุฉ ุงูุชุฑุฎูุต

src/main/ipc/
โโโ licenseHandlers.ts          # ูุนุงูุฌุงุช IPC

src/main/core/database/migrations/
โโโ 0010_hardware_license.sql   # ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ
```

#### Frontend (Renderer Process)
```
src/pages/
โโโ LicenseActivation.tsx       # ุดุงุดุฉ ุงูุชูุนูู

src/components/
โโโ LicenseGuard.tsx            # ุญูุงูุฉ ุงููุณุงุฑุงุช
```

#### Script Tool (ูููุตู)
```
scripts/
โโโ generate-license-key.js     # ุฃุฏุงุฉ ุชูููุฏ ููุงุชูุญ ุงูุชูุนูู
```

---

## ๐ ููููุฉ ุนูู ุงููุธุงู

### 1. ูุนุฑู ุงูุฌูุงุฒ (Hardware ID)

ูุชู ุงูุญุตูู ุนูู ูุนุฑู ูุฑูุฏ ููุฌูุงุฒ ุจูุงุกู ุนูู ูุธุงู ุงูุชุดุบูู:

- **Windows:** Motherboard Serial Number ุฃู System UUID
- **macOS:** IOPlatformUUID
- **Linux:** /etc/machine-id

**ูุซุงู ุนูู Hardware ID:**
```
HWID-WIN-ABC123-XYZ789
HWID-MAC-550E8400-E29B-41D4
HWID-LNX-1A2B3C4D5E6F7G8H
```

### 2. ุชูููุฏ ููุชุงุญ ุงูุชูุนูู

ูุชู ุชูููุฏ ููุชุงุญ ุงูุชูุนูู ุจุงุณุชุฎุฏุงู **HMAC-SHA256**:

```javascript
const signature = HMAC-SHA256(hardwareId, SECRET_KEY)
const activationKey = signature.substring(0, 32)
// Format: XXXX-XXXX-XXXX-XXXX-XXXX-XXXX-XXXX-XXXX
```

### 3. ุงูุชุญูู ูู ุงูุชูุนูู

ุนูุฏ ุชุดุบูู ุงูุชุทุจูู:
1. ููุฑุฃ Hardware ID ุงูุญุงูู
2. ููุงุฑูู ูุน ุงููุฎุฒู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
3. ูุชุญูู ูู ุตุญุฉ ููุชุงุญ ุงูุชูุนูู
4. ุฅุฐุง ุชุทุงุจู ูู ุดูุก โ ููุชุญ ุงูุชุทุจูู
5. ุฅุฐุง ูู ูุชุทุงุจู โ ูุนูุฏ ูุดุงุดุฉ ุงูุชูุนูู

---

## ๐ฆ ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุฌุฏูู License

```sql
CREATE TABLE license (
  id INTEGER PRIMARY KEY CHECK(id = 1),  -- ุณุฌู ูุงุญุฏ ููุท
  hardware_id TEXT NOT NULL,              -- ูุนุฑู ุงูุฌูุงุฒ
  license_key TEXT NOT NULL,              -- ููุชุงุญ ุงูุชูุนูู
  activated_at INTEGER NOT NULL,          -- ุชุงุฑูุฎ ุงูุชูุนูู (epoch)
  is_active INTEGER NOT NULL DEFAULT 1    -- ุญุงูุฉ ุงูุชูุนูู (0/1)
);
```

---

## ๐๏ธ ุฏููู ุงูุงุณุชุฎุฏุงู

### ูููุณุคูู: ุชูููุฏ ููุชุงุญ ุชูุนูู ุฌุฏูุฏ

1. **ุงูุญุตูู ุนูู Hardware ID ูู ุงููุณุชุฎุฏู:**
   - ููุชุญ ุงููุณุชุฎุฏู ุงูุชุทุจูู
   - ูุธูุฑ ูู ุดุงุดุฉ ุงูุชูุนูู ูุน Hardware ID
   - ููุณุฎ ููุฑุณู Hardware ID ูููุณุคูู

2. **ุชูููุฏ ุงูููุชุงุญ:**
```bash
node scripts/generate-license-key.js HWID-WIN-ABC123-XYZ789
```

**ุงููุชูุฌุฉ:**
```
=== Generated Activation Key ===
Hardware ID: HWID-WIN-ABC123-XYZ789
Activation Key: ABCD-1234-EFGH-5678-IJKL-9012-MNOP-3456

โ๏ธ  This key will ONLY work on the device with this Hardware ID!
๐ Copy the activation key and provide it to the user.
```

3. **ุฅุฑุณุงู ุงูููุชุงุญ ูููุณุชุฎุฏู**

### ูููุณุชุฎุฏู: ุชูุนูู ุงูุชุทุจูู

1. ุนูุฏ ูุชุญ ุงูุชุทุจูู ูุฃูู ูุฑุฉุ ุชุธูุฑ ุดุงุดุฉ ุงูุชูุนูู
2. ูุณุฎ Hardware ID (ุฒุฑ ุงููุณุฎ ูุชููุฑ)
3. ุฅุฑุณุงู Hardware ID ูููุณุคูู
4. ุงุณุชูุงู ููุชุงุญ ุงูุชูุนูู
5. ุฅุฏุฎุงู ุงูููุชุงุญ ูู ุงูุญูู ุงููุฎุตุต
6. ุงูุถุบุท ุนูู "ุชูุนูู ุงูุชุทุจูู"
7. โ ุงูุชุทุจูู ููุชุญ ูุจุงุดุฑุฉ

---

## ๐ ุงูุฃูุงู

### ุงูููุชุงุญ ุงูุณุฑู (SECRET_KEY)

```javascript
const SECRET_KEY = 'DENTAL_LAB_2025_SECRET_KEY_CHANGE_IN_PRODUCTION';
```

โ๏ธ **ููู ุฌุฏุงู:**
- ูุฌุจ ุชุบููุฑ ุงูููุชุงุญ ุงูุณุฑู ูุจู ุงููุดุฑ
- ูุฌุจ ุฃู ูููู ููุณ ุงูููุชุงุญ ูู:
  - `scripts/generate-license-key.js`
  - `src/main/core/services/HardwareLicenseService.ts`
- ุนุฏู ูุดุงุฑูุฉ ุงูููุชุงุญ ุงูุณุฑู ุฃู ุฑูุนู ูู GitHub

### ูุง ูููุนู ุงููุธุงู

โ **ูููุน:**
- ุงุณุชุฎุฏุงู ููุณ ุงูููุชุงุญ ุนูู ุฌูุงุฒ ุขุฎุฑ
- ููู ุงูุชุฑุฎูุต ุจูู ุงูุฃุฌูุฒุฉ
- ุชูุนูู ุจุฏูู ููุชุงุญ ุตุญูุญ

โ **ูุง ูููุน:**
- ูุณุฎ ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุฏููุงู (ููู ูู ุชุนูู ุนูู ุฌูุงุฒ ุขุฎุฑ)

---

## ๐งช ุงูุชุฌุฑุจุฉ ูุงูุงุฎุชุจุงุฑ

### ุชูููุฏ ููุชุงุญ ุชุฌุฑูุจู

```bash
# ุชูููุฏ ููุชุงุญ
node scripts/generate-license-key.js TEST-HARDWARE-ID

# ุงูุชุญูู ูู ุงูููุชุงุญ
node scripts/generate-license-key.js TEST-HARDWARE-ID ABCD-1234-EFGH-5678-IJKL-9012-MNOP-3456
```

### ุฅูุบุงุก ุงูุชูุนูู (ููุงุฎุชุจุงุฑ ููุท)

ูู Developer Tools Console:
```javascript
await window.licenseApi.deactivate()
```

---

## ๐ ููุงุญุธุงุช ุงูุชุทููุฑ

### ูุง ุชู ุญุฐูู
- โ `PinLicenseService.ts` (ุงููุธุงู ุงููุฏูู)
- โ ุฌููุน ุฃููุงุฏ PIN ุงูุซุงุจุชุฉ
- โ Migration 0009 (ุชู ุงุณุชุจุฏุงููุง ุจู 0010)

### ูุง ุชู ุฅุถุงูุชู
- โ `HardwareIdService.ts`
- โ `HardwareLicenseService.ts`
- โ `generate-license-key.js`
- โ Migration 0010
- โ ูุงุฌูุฉ ุชูุนูู ุฌุฏูุฏุฉ ูุน ุนุฑุถ Hardware ID

### ุงูุชุนุฏููุงุช
- โ `licenseHandlers.ts` - ุฅุถุงูุฉ `getHardwareId`
- โ `license.types.ts` - ุฅุถุงูุฉ `hardwareId`
- โ `preload.ts` - ุฅุถุงูุฉ API ุฌุฏูุฏ
- โ `LicenseActivation.tsx` - ูุงุฌูุฉ ุฌุฏูุฏุฉ ุจุงููุงูู

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

### ูุจู ุงููุดุฑ

1. โ ุชุบููุฑ SECRET_KEY ุฅูู ูููุฉ ูุฑูุฏุฉ ูุขููุฉ
2. โ ุงุฎุชุจุงุฑ ุงููุธุงู ุนูู ุฃุฌูุฒุฉ ูุฎุชููุฉ
3. โ ุงูุชุฃูุฏ ูู Migration 0010 ุชุนูู ุจุดูู ุตุญูุญ
4. โ ุชูุซูู ุนูููุฉ ุชูููุฏ ุงูููุงุชูุญ

### ูู ุงูุฅูุชุงุฌ

1. ุญูุธ SECRET_KEY ูู ููุงู ุขูู
2. ุนุฏู ูุดุงุฑูุฉ `generate-license-key.js` ูุน ุงููุณุชุฎุฏููู
3. ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ุงูููุงุชูุญ ุงููููุฏุฉ
4. ุชูุซูู ูู ููุชุงุญ ุชู ุฅูุดุงุคู ูุน Hardware ID ุงููุฑุชุจุท ุจู

---

## ๐ ุงูุฏุนู

### ุญู ุงููุดุงูู ุงูุดุงุฆุนุฉ

**ุงููุณุชุฎุฏู: "ุงูููุชุงุญ ูุง ูุนูู"**
- ุชุญูู ุฃู Hardware ID ุงููุฑุณู ูุทุงุจู ููุง ูุธูุฑ ูู ุงูุชุทุจูู
- ุชุญูู ุฃู ุงูููุชุงุญ ุชู ูุณุฎู ุจุงููุงูู ุจุฏูู ูุณุงูุงุช ุฅุถุงููุฉ

**ุงููุณุชุฎุฏู: "ุบูุฑุช ูุทุนุฉ ูู ุงูุฌูุงุฒ ูุงูุขู ุงูุชุทุจูู ูุง ูุนูู"**
- ุชุบููุฑ ุงูููุญุฉ ุงูุฃู = Hardware ID ุฌุฏูุฏ
- ูุญุชุงุฌ ููุชุงุญ ุชูุนูู ุฌุฏูุฏ

**ุงููุณุชุฎุฏู: "ุฃุฑูุฏ ููู ุงูุชุฑุฎูุต ูุฌูุงุฒ ุขุฎุฑ"**
- ุบูุฑ ูููู ูู ุงููุธุงู ุงูุญุงูู
- ูุญุชุงุฌ ููุชุงุญ ุฌุฏูุฏ ููุฌูุงุฒ ุงูุฌุฏูุฏ

---

## โ ูุนุงููุฑ ุงููุจูู (ุชู ุชุญููููุง)

- โ ุญุฐู ุงููุธุงู ุงููุฏูู ุจุงููุงูู
- โ ูู ุฌูุงุฒ ูู Hardware ID ูุฑูุฏ
- โ ูู ููุชุงุญ ูุฑุชุจุท ุจุฌูุงุฒ ูุงุญุฏ ููุท
- โ ูุง ูููู ุชุดุบูู ุงูููุชุงุญ ุนูู ุฌูุงุฒ ุขุฎุฑ
- โ ุจุนุฏ ุงูุชูุนูู ููุชุญ ุงูุชุทุจูู ูุจุงุดุฑุฉ
- โ ูู ุญุงู ุชุบููุฑ ุงูุฌูุงุฒ ูุนูุฏ ูุดุงุดุฉ ุงูุชูุนูู
- โ ุงููุธุงู ูุนูู Offline ุจุงููุงูู
- โ ูุงุฌูุฉ ุณููุฉ ุงูุงุณุชุฎุฏุงู

---

**ุชู ุงูุชูููุฐ ุจูุฌุงุญ โ**